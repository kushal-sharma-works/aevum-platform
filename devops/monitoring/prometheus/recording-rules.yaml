groups:
  - name: aevum-precomputed
    interval: 30s
    rules:
      - record: aevum:ingestion_rate:1m
        expr: rate(aevum_events_ingested_total[1m])

      - record: aevum:decision_rate:1m
        expr: rate(aevum_decisions_evaluated_total[1m])

      - record: aevum:ingestion_latency_p50:5m
        expr: histogram_quantile(0.50, rate(aevum_ingestion_duration_seconds_bucket[5m]))

      - record: aevum:ingestion_latency_p95:5m
        expr: histogram_quantile(0.95, rate(aevum_ingestion_duration_seconds_bucket[5m]))

      - record: aevum:ingestion_latency_p99:5m
        expr: histogram_quantile(0.99, rate(aevum_ingestion_duration_seconds_bucket[5m]))

      - record: aevum:evaluation_latency_p50:5m
        expr: histogram_quantile(0.50, rate(aevum_evaluation_duration_seconds_bucket[5m]))

      - record: aevum:evaluation_latency_p95:5m
        expr: histogram_quantile(0.95, rate(aevum_evaluation_duration_seconds_bucket[5m]))

      - record: aevum:evaluation_latency_p99:5m
        expr: histogram_quantile(0.99, rate(aevum_evaluation_duration_seconds_bucket[5m]))

      - record: aevum:error_rate:5m
        expr: sum(rate(aevum_events_ingested_total{status="error"}[5m])) / sum(rate(aevum_events_ingested_total[5m]))
